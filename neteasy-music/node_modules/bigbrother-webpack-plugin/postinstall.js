const isAliEnv = require('is-ali-env');
const spawn = require('child_process').spawn;
const join = require('path').join;

isAliEnv().then(function(_isAliEnv) {
  if (!_isAliEnv) {
    return;
  }

  // ref: https://stackoverflow.com/questions/37459717/error-spawn-enoent-on-windows
  let bin = 'tnpm';
  let params = ['i', '@alipay/satori-client'];
  
  // windows
  if (/^win/.test(process.platform)) {
    bin = 'cmd';
    params = ['/s', '/c', 'tnpm'].concat(params);
  }

  child = spawn(bin, params, {
    cwd: join(__dirname, '.'),
    stdio: ['ignore', 'ignore', 'ignore'],
  });
  child.on('message', () => {});
  child.on('exit', () => {});
  child.on('error', () => {});
});
